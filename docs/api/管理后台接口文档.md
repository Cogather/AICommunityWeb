# 管理后台接口文档

## 概述

管理后台用于配置平台各模块的内容，包括：
1. 首页管理（轮播图、荣誉殿堂Banner、AI工具配置）
2. AI优秀实践管理（精华帖子）
3. 赋能交流管理（精华帖子、精选合集）
4. AI工具专区管理（其他工具精华帖子）
5. AI使用达人管理（个人奖项、获奖者、团队奖项）
6. 人员管理（管理员、工具Owner）
7. 扶摇Agent应用管理（置顶帖子）

---

## 权限说明

| 角色 | 说明 | 权限 |
|------|------|------|
| admin | 管理员 | 全部管理后台功能 |
| tool_owner | 工具Owner | 对应工具的活动发布、帖子管理 |

---

## 接口列表

### 1. 首页管理

#### 1.1 获取轮播图配置

**请求**

```
GET /api/admin/carousel
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "image": "https://example.com/banner1.jpg",
        "link": "/practices",
        "showContent": true,
        "title": "AI 优秀实践",
        "desc": "探索大模型在企业级应用中的最佳落地场景",
        "order": 1
      }
    ]
  }
}
```

#### 1.2 保存轮播图配置

**请求**

```
PUT /api/admin/carousel
```

**请求体**

```json
{
  "list": [
    {
      "id": 1,
      "image": "https://example.com/banner1.jpg",
      "link": "/practices",
      "showContent": true,
      "title": "AI 优秀实践",
      "desc": "探索大模型在企业级应用中的最佳落地场景",
      "order": 1
    }
  ]
}
```

**响应**

```json
{
  "code": 200,
  "message": "保存成功",
  "data": null
}
```

---

#### 1.3 获取荣誉殿堂Banner配置

**请求**

```
GET /api/admin/honor/banner
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "bannerImage": "https://example.com/honor-banner.jpg"
  }
}
```

#### 1.4 保存荣誉殿堂Banner配置

**请求**

```
PUT /api/admin/honor/banner
```

**请求体**

```json
{
  "bannerImage": "https://example.com/honor-banner.jpg"
}
```

---

#### 1.5 获取AI工具配置

**请求**

```
GET /api/admin/tools
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "TestMate",
        "desc": "自动化测试助手",
        "logo": "https://example.com/logo.png",
        "color": "#36cfc9",
        "link": "/tools/testmate"
      }
    ]
  }
}
```

#### 1.6 保存AI工具配置

**请求**

```
PUT /api/admin/tools
```

**请求体**

```json
{
  "list": [
    {
      "id": 1,
      "name": "TestMate",
      "desc": "自动化测试助手",
      "logo": "https://example.com/logo.png",
      "color": "#36cfc9",
      "link": "/tools/testmate"
    }
  ]
}
```

---

#### 1.7 获取AI工具专区Banner配置

**请求**

```
GET /api/admin/tool-banners
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "image": "https://example.com/tool-banner.jpg",
        "title": "最新 AI 工具推荐",
        "desc": "探索最新发布的 AI 工具，提升你的工作效率"
      }
    ]
  }
}
```

#### 1.8 保存AI工具专区Banner配置

**请求**

```
PUT /api/admin/tool-banners
```

---

### 2. 精华/置顶帖子管理

> **说明**：精华/置顶帖子由管理员在帖子详情页面直接操作设置，管理后台仅用于查看和移除。

#### 2.1 设置帖子精华/置顶状态

管理员在帖子详情页面点击"加精"或"置顶"按钮时调用此接口。

**请求**

```
PUT /api/posts/{postId}/featured
```

**请求参数**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| postId | number | 是 | 帖子ID（路径参数） |

**请求体**

```json
{
  "featured": true,
  "zone": "practices",
  "toolId": null
}
```

**请求字段说明**

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| featured | boolean | 是 | 是否设为精华/置顶 |
| zone | string | 否 | 所属区域：practices/empowerment/agent/tools |
| toolId | number | 否 | 工具ID（AI工具专区使用，其他工具为0） |

**响应**

```json
{
  "code": 200,
  "message": "设置成功",
  "data": {
    "success": true,
    "featured": true
  }
}
```

---

#### 2.2 获取所有精华/置顶帖子列表

管理后台"精华置顶帖子管理"页签使用，按区域分组返回所有精华/置顶帖子。

**请求**

```
GET /api/admin/featured-posts/all
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "practices": [
      {
        "id": 1,
        "title": "AI大会2024",
        "author": "张三",
        "createTime": "2024-01-10T10:00:00Z",
        "zone": "practices"
      }
    ],
    "empowerment": [],
    "agent": [
      {
        "id": 101,
        "title": "扶摇Agent入门指南",
        "author": "李四",
        "createTime": "2024-01-08T14:30:00Z",
        "zone": "agent"
      }
    ],
    "otherTools": []
  }
}
```

**响应字段说明**

| 字段 | 类型 | 说明 |
|------|------|------|
| practices | array | AI优秀实践精华帖子列表 |
| empowerment | array | 赋能交流精华帖子列表 |
| agent | array | 扶摇Agent置顶帖子列表 |
| otherTools | array | AI工具专区其他工具精华帖子列表 |

---

#### 2.3 移除帖子精华/置顶状态

管理后台"精华置顶帖子管理"页签点击"取消精华/置顶"时调用。

**请求**

```
DELETE /api/admin/featured-posts/{postId}
```

**响应**

```json
{
  "code": 200,
  "message": "移除成功",
  "data": {
    "success": true
  }
}
```

---

#### 2.4 获取赋能交流精选合集配置

**请求**

```
GET /api/admin/empowerment/collections
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "postId": 1,
        "note": "顶级AI研究论文"
      }
    ]
  }
}
```

#### 2.5 保存赋能交流精选合集配置

**请求**

```
PUT /api/admin/empowerment/collections
```

---

### 精华/置顶功能说明

| 区域 | 功能名称 | 说明 |
|------|---------|------|
| AI优秀实践 | 精华 | 精华帖子置顶显示 |
| 赋能交流 | 精华 | 精华帖子置顶显示，不参与分页和筛选 |
| 扶摇Agent应用 | 置顶 | 置顶帖子优先显示 |
| AI工具专区-其他工具 | 精华 | 精华帖子在帖子列表内置顶显示 |
| AI工具专区-普通工具 | 无 | 无精华/置顶功能 |

---

### 3. AI使用达人管理

#### 3.1 获取奖项设置列表

**请求**

```
GET /api/admin/awards
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "年度最佳贡献奖",
        "description": "表彰在AI社区中做出卓越贡献的成员"
      }
    ]
  }
}
```

#### 3.2 保存奖项设置列表

**请求**

```
PUT /api/admin/awards
```

**请求体**

```json
{
  "list": [
    {
      "id": 1,
      "name": "年度最佳贡献奖",
      "description": "表彰在AI社区中做出卓越贡献的成员"
    }
  ]
}
```

---

#### 3.3 获取奖项名称列表（下拉选择用）

用于获奖者管理页面的奖项名称下拉选择。

**请求**

```
GET /api/admin/awards/names
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "年度最佳贡献奖"
      },
      {
        "id": 2,
        "name": "AI创新突破奖"
      },
      {
        "id": 3,
        "name": "最佳实践奖"
      }
    ]
  }
}
```

---

#### 3.4 获取获奖者列表

**请求**

```
GET /api/admin/winners
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "张工程师",
        "awardTime": "2024-01",
        "awardName": "年度最佳贡献奖"
      }
    ]
  }
}
```

**字段说明**

| 字段 | 类型 | 说明 |
|------|------|------|
| id | number | 获奖记录ID |
| name | string | 获奖者姓名 |
| awardTime | string | 获奖时间（YYYY-MM格式） |
| awardName | string | 奖项名称（从奖项设置中选择） |

> **说明**：`awardName` 的选项从 `GET /api/admin/awards/names` 接口获取。

#### 3.5 保存获奖者列表

**请求**

```
PUT /api/admin/winners
```

---

#### 3.6 获取获奖者推荐列表

根据积分自动推荐Top用户。

**请求**

```
GET /api/admin/winners/recommended
```

**请求参数**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| month | string | 否 | 月份，格式YYYY-MM，默认当前月 |

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "employeeId": "E001",
        "name": "张三",
        "avatar": "https://example.com/avatar.jpg",
        "department": "研发部",
        "points": 1200,
        "postsCount": 15,
        "commentsCount": 42,
        "activitiesCount": 8,
        "likesReceived": 156,
        "favoritesReceived": 45,
        "hasAwarded": false,
        "honorId": null
      }
    ]
  }
}
```

---

#### 3.7 设置用户获奖

**请求**

```
POST /api/admin/winners/set-award
```

**请求体**

```json
{
  "userId": 1,
  "awardId": 1,
  "awardDate": "2024-01"
}
```

**响应**

```json
{
  "code": 200,
  "message": "设置成功",
  "data": {
    "honorId": 100
  }
}
```

---

#### 3.8 取消用户获奖

**请求**

```
DELETE /api/admin/winners/cancel-award
```

**请求体**

```json
{
  "userId": 1,
  "honorId": 100
}
```

---

#### 3.9 获取团队奖项列表

**请求**

```
GET /api/admin/team-awards
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "title": "年度最佳团队奖",
        "year": 2024,
        "images": [
          {
            "id": 1,
            "image": "https://example.com/team1.jpg",
            "winnerName": "AI研发团队",
            "teamField": "人工智能"
          }
        ]
      }
    ]
  }
}
```

**字段说明**

| 字段 | 类型 | 说明 |
|------|------|------|
| id | number | 奖项ID |
| title | string | 奖项名称 |
| year | number | 年份 |
| images | array | 获奖照片列表 |
| images[].id | number | 照片ID |
| images[].image | string | 照片URL |
| images[].winnerName | string | 获奖团队名称 |
| images[].teamField | string | 团队所属领域 |

#### 3.10 保存团队奖项列表

**请求**

```
PUT /api/admin/team-awards
```

**请求体**

```json
{
  "list": [
    {
      "id": 1,
      "title": "年度最佳团队奖",
      "year": 2024,
      "images": [
        {
          "id": 1,
          "image": "https://example.com/team1.jpg",
          "winnerName": "AI研发团队",
          "teamField": "人工智能"
        }
      ]
    }
  ]
}
```

---

### 4. 人员管理

#### 4.1 获取用户列表

**请求**

```
GET /api/admin/users
```

**请求参数**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| keyword | string | 否 | 搜索关键词（姓名、邮箱） |
| role | string | 否 | 角色筛选：admin/tool_owner |

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "张三",
        "email": "zhangsan@example.com",
        "department": "研发部",
        "role": "admin"
      }
    ]
  }
}
```

**字段说明**

| 字段 | 类型 | 说明 |
|------|------|------|
| id | number | 用户ID |
| name | string | 姓名 |
| email | string | 邮箱 |
| department | string | 部门 |
| role | string | 角色：admin（管理员）、tool_owner（工具Owner） |

---

#### 4.2 添加管理员/工具Owner

**请求**

```
POST /api/admin/users/role
```

**请求体**

```json
{
  "userId": 1,
  "role": "admin"
}
```

**请求参数说明**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| userId | number | 是 | 用户ID |
| role | string | 是 | 角色：admin（管理员）、tool_owner（工具Owner） |

**响应**

```json
{
  "code": 200,
  "message": "设置成功",
  "data": null
}
```

---

#### 4.3 移除管理员/工具Owner

**请求**

```
DELETE /api/admin/users/role
```

**请求体**

```json
{
  "userId": 1,
  "role": "admin"
}
```

---

#### 4.4 根据用户ID查找用户

**请求**

```
GET /api/admin/users/{userId}
```

**响应**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "name": "张三",
    "email": "zhangsan@example.com",
    "department": "研发部",
    "role": "user"
  }
}
```

---

### 5. 图片上传

#### 5.1 上传图片

**请求**

```
POST /api/admin/upload/image
```

**请求体**

`multipart/form-data` 格式，包含 `file` 字段

**响应**

```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "url": "https://example.com/uploaded-image.jpg"
  }
}
```

---

## 错误码说明

| 错误码 | 说明 |
|-------|------|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 401 | 未登录或登录已过期 |
| 403 | 无权限（非管理员） |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

---

## 前端使用示例

### 加载配置

```typescript
import { 
  getCarouselConfig, 
  getHonorBannerConfig,
  getToolsConfig,
  getTeamAwardsConfig,
  getAwardNamesList  // 获取奖项名称列表
} from '../mock'

onMounted(async () => {
  // 加载轮播图配置
  const carouselRes = await getCarouselConfig()
  carouselList.value = carouselRes.list
  
  // 加载奖项名称列表（用于获奖者管理的下拉选择）
  const awardsRes = await getAwardNamesList()
  awardOptions.value = awardsRes.list
})
```

### 保存配置

```typescript
import { 
  saveCarouselConfig,
  saveTeamAwardsConfig
} from '../mock'

const handleSave = async () => {
  await saveCarouselConfig(carouselList.value)
  await saveTeamAwardsConfig(teamAwardsList.value)
  ElMessage.success('保存成功')
}
```

---

## 数据字典

### 用户角色

| 值 | 说明 |
|------|------|
| admin | 管理员，拥有全部管理后台权限 |
| tool_owner | 工具Owner，拥有对应工具的活动发布和帖子管理权限 |
| user | 普通用户 |

### 精华帖子配置结构

| 字段 | 类型 | 说明 |
|------|------|------|
| id | number | 配置项ID（前端生成） |
| postId | number | 帖子ID |
| note | string | 备注信息（可选） |

### 团队奖项图片结构

| 字段 | 类型 | 说明 |
|------|------|------|
| id | number | 图片ID |
| image | string | 图片URL |
| winnerName | string | 获奖团队名称 |
| teamField | string | 团队所属领域 |
