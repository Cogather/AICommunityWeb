# 前后端接口匹配说明文档

## 一、已修复的接口匹配问题

### 1. 响应拦截器修复 (`frontend/src/api/request.ts`)
- ✅ 修复了响应拦截器，正确处理后端 `Result<T>` 包装格式
- ✅ 自动提取 `data` 字段，处理业务错误码

### 2. 首页接口 (`frontend/src/api/home.ts`)

#### ✅ `getCarousel()` - 获取首页轮播图
- **后端返回**: `Result<CarouselResponse>`，其中 `CarouselResponse.list` 是轮播图列表
- **前端处理**: 直接使用 `{ list: CarouselItem[] }`
- **状态**: ✅ 已匹配

#### ✅ `getHonor()` - 获取荣誉殿堂信息
- **后端返回**: `Result<HonorHomeResponse>`，包含 `honor` 和 `news` 字段
- **前端处理**: 只提取 `honor` 字段，转换 `TopUser.level` -> `honorCount`
- **状态**: ✅ 已匹配

#### ✅ `getTools()` - 获取工具列表
- **后端返回**: `Result<List<Tool>>`
- **前端处理**: 转换为 `{ list: ToolItem[] }`
- **参数**: 支持 `featured` 参数
- **状态**: ✅ 已匹配

#### ⚠️ `getToolBanners()` - 获取工具Banner列表
- **后端情况**: 没有单独的 `/tools/banners` 接口
- **前端处理**: 
  - 如果指定 `toolId`，从工具详情获取 `banners`
  - 否则从所有工具中收集 `banners` 并排序
- **状态**: ⚠️ 已适配，但需要从工具配置中获取

#### ⚠️ `getPractices()` - 获取AI优秀实践内容
- **后端情况**: 没有 `/home/practices` 接口
- **前端处理**: 尝试调用接口，失败时返回空数据
- **建议**: 后端需要实现此接口，或通过帖子接口按 `category` 分类获取
- **状态**: ⚠️ 需要后端实现

### 3. AI优秀实践接口 (`frontend/src/api/practices.ts`)

#### ✅ `getPosts()` - 获取帖子列表
- **后端返回**: `Result<PageResult<Post>>`
- **前端处理**: 
  - 转换为 `PostsResponse` 格式
  - 字段映射：`authorName` -> `author`，`summary` -> `description`
  - 字段映射：`isFeatured` -> `featured`
- **参数**: 支持 `zone`, `toolId`, `search`, `sort`, `tag`, `department`, `author`, `page`, `pageSize`
- **状态**: ✅ 已匹配

#### ✅ `getHotPosts()` - 获取最热帖子
- **后端返回**: `Result<List<Post>>`
- **前端处理**: 转换为 `{ list: Post[] }`，并进行字段映射
- **状态**: ✅ 已匹配

#### ✅ `getTags()` - 获取标签列表
- **后端返回**: `Result<List<TagInfo>>`
- **前端处理**: 转换为 `{ list: Tag[] }`
- **参数**: `zone` (必填), `toolId` (可选)
- **状态**: ✅ 已匹配

#### ✅ `getDepartments()` - 获取部门统计
- **后端返回**: `Result<List<DepartmentStatsResponse>>`
- **前端处理**: 转换为 `{ list: DepartmentStats[] }`
- **参数**: `zone` (可选)
- **状态**: ✅ 已匹配

#### ✅ `getTopContributors()` - 获取热门贡献者
- **后端返回**: `Result<List<TopContributorResponse>>`
- **前端处理**: 转换为 `{ list: TopContributor[] }`
- **参数**: `zone` (可选), `limit` (可选，默认10)
- **状态**: ✅ 已匹配

### 4. AI使用达人接口 (`frontend/src/api/users.ts`)

#### ⚠️ `getTeamAwards()` - 获取团队荣誉列表
- **后端情况**: 后端没有实现 `/team-awards` 接口
- **前端处理**: 尝试调用接口，失败时返回空列表
- **建议**: 后端需要创建 `TeamAwardController` 实现此接口
- **状态**: ⚠️ 需要后端实现

#### ⚠️ `getTeamAwardDetail()` - 获取团队荣誉详情
- **后端情况**: 后端没有实现 `/team-awards/:id` 接口
- **前端处理**: 尝试调用接口，失败时返回空对象
- **建议**: 后端需要实现此接口
- **状态**: ⚠️ 需要后端实现

### 5. 管理后台接口 (`frontend/src/api/admin.ts`)

#### ✅ `getCarouselConfig()` - 获取首页轮播图配置
- **后端返回**: `Result<CarouselResponse>`
- **状态**: ✅ 已匹配

#### ✅ `saveCarouselConfig()` - 保存首页轮播图配置
- **后端请求**: `CarouselResponse { list: CarouselItem[] }`
- **状态**: ✅ 已匹配

#### ✅ `getHonorBannerConfig()` - 获取荣誉殿堂Banner配置
- **后端返回**: `Result<HonorBannerResponse>`
- **状态**: ✅ 已匹配

#### ✅ `getHonorAwardsConfig()` - 获取荣誉殿堂奖项配置
- **后端返回**: `Result<HonorAwardsResponse>`
- **状态**: ✅ 已匹配

#### ✅ `getToolsConfig()` - 获取AI工具配置
- **后端返回**: `Result<ToolsConfigResponse>`，其中包含 `list` 字段
- **状态**: ✅ 已匹配

#### ⚠️ `getToolBannersConfig()` - 获取工具Banner配置
- **后端情况**: 工具Banner是工具配置的一部分（`ToolsConfigResponse.ToolItem.banners`）
- **前端处理**: 从工具配置中提取所有banners
- **状态**: ⚠️ 已适配，但需要从工具配置中提取

#### ⚠️ `getPersonalAwardsConfig()` - 获取个人奖项配置
- **后端情况**: 后端可能还没有实现 `/admin/users/awards` 接口
- **前端处理**: 尝试调用接口，失败时返回空列表
- **建议**: 后端需要实现此接口
- **状态**: ⚠️ 需要后端实现

#### ⚠️ `getWinnersConfig()` - 获取获奖者列表
- **后端情况**: 后端可能还没有实现 `/admin/users/winners` 接口
- **前端处理**: 尝试调用接口，失败时返回空列表
- **建议**: 后端需要实现此接口
- **状态**: ⚠️ 需要后端实现

#### ⚠️ `getTeamAwardsConfig()` - 获取团队奖项配置
- **后端情况**: 后端可能还没有实现 `/admin/users/team-awards` 接口
- **前端处理**: 尝试调用接口，失败时返回空列表
- **建议**: 后端需要实现此接口
- **状态**: ⚠️ 需要后端实现

#### ✅ `getRecommendedWinners()` - 获取本月积分排行榜
- **后端返回**: `Result<RecommendedWinnersResponse>`，包含 `list` 和 `month` 字段
- **前端处理**: 直接使用返回结果
- **状态**: ✅ 已匹配

#### ✅ `setUserAward()` - 设置用户获奖
- **后端请求**: `HonorCreateRequest`
- **后端返回**: `Result<HonorCreateResponse>`，包含 `id` 和 `message` 字段
- **状态**: ✅ 已匹配

#### ✅ `cancelUserAward()` - 取消用户获奖
- **后端返回**: `Result<?>`
- **状态**: ✅ 已匹配

#### ✅ `getAwardsList()` - 获取奖项列表
- **后端返回**: `Result<List<Award>>`
- **前端处理**: 转换为 `{ list: AwardItem[] }`
- **状态**: ✅ 已匹配

#### ✅ `searchUsers()` - 搜索用户
- **后端返回**: `Result<List<User>>`
- **前端处理**: 转换为 `{ list: UserItem[] }`
- **状态**: ✅ 已匹配

#### ✅ `getUsersList()` - 获取用户列表
- **后端返回**: `Result<PageResult<User>>`
- **前端处理**: 转换为 `{ list: UserItem[]; total: number }`
- **注意**: 后端 `User` 实体没有 `currentRole` 和 `ownedTools` 字段，这些可能需要从其他接口获取或计算
- **状态**: ✅ 已匹配（字段可能需要额外处理）

#### ✅ `addUserRole()` - 添加用户角色
- **后端请求**: `UserRoleRequest { role, toolId?, employeeId? }`
- **后端返回**: `Result<?>`
- **状态**: ✅ 已匹配

#### ✅ `removeUserRole()` - 移除用户角色
- **后端请求**: `UserRoleRequest { role, toolId? }` (通过RequestBody传递)
- **后端返回**: `Result<?>`
- **状态**: ✅ 已匹配

#### ✅ `uploadImage()` - 上传图片
- **后端返回**: `Result<ImageUploadResponse>`，包含 `url` 字段
- **状态**: ✅ 已匹配

## 二、字段映射说明

### Post 实体字段映射
- `authorName` (后端) -> `author` (前端)
- `summary` (后端) -> `description` (前端)
- `isFeatured` (后端) -> `featured` (前端)
- `cover` 和 `image` 字段兼容处理

### TopUser 字段映射
- `level` (后端) -> `honorCount` (前端，如果honorCount不存在)

## 三、需要后端实现的接口

### 1. 团队荣誉相关接口
- ❌ `GET /api/team-awards` - 获取团队荣誉列表
- ❌ `GET /api/team-awards/:id` - 获取团队荣誉详情
- **建议**: 创建 `TeamAwardController` 实现这些接口

### 2. 首页AI优秀实践接口
- ❌ `GET /api/home/practices` - 获取AI优秀实践内容（三块列表）
- **建议**: 在 `HomeController` 中添加此接口，或通过帖子接口按category分类获取

### 3. 管理后台AI使用达人管理接口
- ❌ `GET /api/admin/users/awards` - 获取个人奖项配置
- ❌ `PUT /api/admin/users/awards` - 保存个人奖项配置
- ❌ `GET /api/admin/users/winners` - 获取获奖者列表
- ❌ `PUT /api/admin/users/winners` - 保存获奖者列表
- ❌ `GET /api/admin/users/team-awards` - 获取团队奖项配置
- ❌ `PUT /api/admin/users/team-awards` - 保存团队奖项配置
- **建议**: 在 `AdminController` 中添加这些接口

### 4. 工具Banner接口（可选）
- ⚠️ `GET /api/tools/banners` - 获取工具Banner列表（可选，因为可以从工具配置中获取）
- **建议**: 如果需要单独的Banner管理接口，可以添加；否则从工具配置中获取即可

## 四、接口返回格式说明

### 后端统一返回格式
```typescript
interface Result<T> {
  code: number      // 200表示成功
  message: string   // 响应消息
  data: T          // 实际数据
  timestamp?: number // 时间戳
}
```

### 前端处理方式
- 响应拦截器自动提取 `data` 字段
- 如果 `code !== 200`，返回错误
- 前端API函数直接返回 `data` 的内容

## 五、注意事项

1. **字段兼容性**: 前端已处理字段映射（如 `authorName` -> `author`），确保前端代码正常工作
2. **缺失接口**: 对于后端未实现的接口，前端已添加错误处理，返回空数据，不会导致页面崩溃
3. **类型安全**: 所有接口都使用TypeScript类型定义，确保类型安全
4. **错误处理**: 所有接口调用都包含错误处理，确保在接口不存在或失败时不会影响用户体验

## 六、后续工作建议

1. **后端实现缺失接口**: 按照API接口需求文档实现团队荣誉、首页practices、管理后台AI使用达人管理相关接口
2. **字段统一**: 建议后端统一字段命名（如统一使用 `author` 而不是 `authorName`）
3. **接口测试**: 实现接口后，需要测试前后端数据格式是否完全匹配
